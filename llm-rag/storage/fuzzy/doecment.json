["FuzzyKey:ComparingFuzzyCryptographicPrimitivesonResource-ConstrainedDevices\nMoZhang1,4(B),EduardMarin2,DavidOswald1,andDaveSingel´ee3\n1UniversityofBirmingham,Birmingham,UKmxz819@cs.bham.ac.uk,d.f.oswald@bham.ac.uk2TelefonicaResearch,Madrid,Spaineduard.marinfabregas@telefonica.com3imec-COSIC,KULeuven,Leuven,Belgiumdave.singelee@esat.kuleuven.be4UniversityofMelbourne,Parkville,Australia\nAbstract.Implantablemedicaldevices,sensorsandwearablesarewidelydeployedtoday.However,establishingasecurewirelesscommunicationchanneltothesedevicesisamajorchallenge,amongstothersduetotheconstraintsonenergyconsumptionandtheneedtoobtainimmediateaccessinemergencies.Toaddressthisissue,researchershaveproposedvariouskeyagreementprotocolsbasedonthemeasurementofphysiologicalsignalssuchasaperson’sheartsignal.Atthecoreofsuchprotocolsarefuzzycryptographicprimitivesthatallowtoagreeonasharedsecretbasedonseveralsimultaneous,noisymeasurementsofthesamesignal.Sofar,althoughmanyfuzzyprimitiveshavebeenproposed,thereisnocomprehensiveevaluationandcomparisonyetoftheoverheadthatsuchmethodsincuronresource-constrainedembeddeddevices.Inthispaper,westudythefeasibilityofsixtypesoffuzzycryptographicprimitivesonembeddeddevicesfor128-bitkeyagreement.WeconﬁgureseveralvariantsforeachfuzzyprimitiveunderdiﬀerentparameterselectionsandmismatchratesofthephysiologicalsignalmeasurementsonanMSP430microcontroller,andthenmeasureandcomparetheirenergyconsumptionandcommunicationoverhead.Themosteﬃcientconstructionsconsumebetween0.021mJand0.198mJforthetransmitterandbetween0.029mJand0.380mJforthereceiverunderdiﬀerentmismatchrates.Subsequently,wemodifythebestperformingmethodssothattheyruninconstanttimetoprotectagainsttimingside-channelattacks,andobservethatthesechangesonlyminimallyaﬀectresourceconsumption.Finally,weprovideopen-sourceimplementationsandenergyconsumptiondataofeachfuzzyprimitiveasareferenceforreal-worlddesigns.\nKeywords:Fuzzycommitment·Fuzzyvault·Fuzzyextractor·Physiologicalsignal·Keyagreement·Energyconsumption\nc(cid:2)SpringerNatureSwitzerlandAG2022V.GrossoandT.P¨oppelmann(Eds.):CARDIS2021,LNCS13173,pp.289–309,2022.https://doi.org/10.1007/978-3-030-97348-3_16\n", "cid:2)SpringerNatureSwitzerlandAG2022V.GrossoandT.P¨oppelmann(Eds.):CARDIS2021,LNCS13173,pp.289–309,2022.https://doi.org/10.1007/978-3-030-97348-3_16\nM.Zhangetal.1Introduction\nHealthcaretechnologyisevolvingatarapidpace.Medicalsensorsaregettingmoreminiaturised,whilebeingabletomeasureabroadersetofpeople’sPhysiologicalSignals(PSs)morereliably.Newgenerationsofwidely-deployedImplantableMedicalDevices(IMDs)areconsiderablylighterandsmallercomparedtopreviousgenerations.Wearablesareextensivelyusednowadays,alsooftenwithinthecontextofhealthmonitoring.Multiplewearableandmedicalcomputingdevicescanbeconnectedtoformabodyareanetwork.Besidestheirapplicationopportunitieswithinthehealthdomain,allthesedeviceshaveincommonthattheyrelyonawirelessinterfacetocommunicatewitheachotherorwithexternaldevicessuchasasmartphone.Thisincreasedwirelessconnectivityenhanceswithoutanydoubtthequalityofthe(remote)healthcarethatcanbeoﬀeredtousers.However,inturn,securityandprivacyareatstakeforsuchmedicalsystems.Themedicaldatathatisbeingmonitoredontheuserisclearlyprivacy-sensitive.Moreover,theintegrityandauthenticityofthedata,aswellasremoteupdatesorcommandssenttothedevices,havetobeprotectedaswell.Unfortunately,researchershavedemonstratedthatseveralmedicalandwearabledevicesavailableonthemarketcurrentlylacksecuritymechanisms[11,22–24,29].\nItisthereforeevidentthatcryptographicsolutionsareneededtosecurethewirelessinterfacebetweenthesedevices.Thisincludestheinitialsecuritybootstrapprocesstoestablishasecretsessionkeytoprotectthewirelesscommunicationlink.However,thisturnsouttobeachallengingresearchproblemforvariousreasons.First,mostofthesedeviceshavestrictresourceconstraints,e.g.,limitedmemoryandcomputationalpower.Furthermore,mostIMDsareoperatedbyasinglenon-rechargeableandnon-replaceablebatterywhichtypicallylastsbetweenﬁveandsevenyears(dependingonthetypeofdeviceandtreatment).Oncethebatteryisdrained,theIMDisreplacedthroughasurgicalinterventionthatcanposeriskstopatients.Likewise,wearablestypicallycontainsmallbatteries,e.g.,poweredbyabuttoncellwithapproximateathousandjoules.Thus,insuchresource-constraineddeviceseverysinglejoulematters.Second,thesedevicesoftendonothaveanyinputoroutputinterfaces,suchasakeypadorascreen.Third,asubsetofthesemedicaldevices,moreparticularlyIMDs,arenotevenphysicallyaccessibleatall,becausetheyareimplantedinthepatient.Fourth,mostofthewirelessconnectionsthathavetobemadewiththesedevicescannotrelyonanypriortrustrelation.Thisisbecausethesenetworkconnectionsarenotstatic,i.e.,thesetofexternaldevicesoneneedstoconnecttocanchangequiteoften.Forexample,duringanemergencysituation,theﬁrstdoctorthatispresent(whomayhaveneverseenthepatientbefore)mighthavetoestablishacommunicationlinktothepatient’sIMD.Duetoalltheseconstraints,conventionalkeydistributionandbootstraptechniquesarenotviableoptions:keyexchangesbasedonpublickeycryptographyarediﬃculttomanagebecausetheyrequireestablishmentofarobustPublicKeyInfrastructure(PKI).\n", "esarenotviableoptions:keyexchangesbasedonpublickeycryptographyarediﬃculttomanagebecausetheyrequireestablishmentofarobustPublicKeyInfrastructure(PKI).\nTheuseofphysiologicalsignals(e.g.,asignalextractedfromtheuser’sheartbeat)hasbeenproposedasanalternativetosecurelyestablishakeybetweentwodevicesthatdonothaveanypriortrustrelationship.Incontrasttobiometrics,wheretheextractedinformationistosomeextentinvariant,PSsarerequiredtoberandomsignalsthatvaryovertime.ThesecurityofPS-basedcryptographicsolutionsreliesonthefactthattheuser’sPScanonlybeobtainedbymakingphysicalcontactwiththem(e.g.,bytouchingtheskinlongenough).Acommonapproachtoagreeonakeyisforeachofthedevicestoindependentlyandsynchronouslytakeameasurementofagivenuser’sPS[20,21].However,themeasurementstakenbythedevicesareoftennotidenticalbutatbestrathersimilarduetoinherentnoiseintroducedbythemeasuringprocess.Toaddressthislimitation,Juelsetal.[15,16]andDodisetal.[10]introducedso-calledfuzzycryptographicprimitives,includingthefuzzycommitment[16],fuzzyvault[15]andfuzzyextractor[10],whichallowtwodevicestoagreeacryptographickeyfromnoisydata.1\n1.1RelatedWork\nFuzzycryptographicprimitiveshavebecomethebasisofseveralPS-basedcryptographicprotocols.Forexample,KVenkatasubramanianetal.[38],Huetal.[14]andReshanetal.[4]utilisedthefuzzyvaultforkeyagreementbasedonmeasurementsofInterPulseIntervals(IPIs),i.e.,timeintervalsbetweenR-peaksofElectrocardiogram(ECG)signal.Similarly,Cherukurietal.proposedaPSbasedkeydistributionprotocolbasedonthefuzzycommitmentthatisusedtosecurelytransportasessionkeybetweentwosensors[7].AnotherexampleisthekeyagreementprotocolbyMarinetal.whichusesafuzzyextractorincombinationwithIPIs[21].ItisworthnotingthatthesecurityofPS-basedkeyexchangeprotocolshasbeenexhaustivelyinvestigatedoverthepastyears.Inparticular,Callejaetal.[6]andSeepersetal.[32]demonstratedthatsomePS,suchasthoseextractedfromthepatient’sheart,mightbemeasuredremotelywithouttheneedfordirectphysicaltouch.Besides,theentropyofthePSitselfhasbeenquestioned,e.g.,althoughIPIwasfrequentlychosenasthePSusedinpriorsecurityprotocols,Ortiz-Martinetal.[26]challengedthatIPIsmaynothaveasmuchentropyasexpected.Furthermore,somePS-basedkeyexchangeprotocols,suchas[7,30],havebeenprovedtobevulnerabletocertainattacks\n", "engedthatIPIsmaynothaveasmuchentropyasexpected.Furthermore,somePS-basedkeyexchangeprotocols,suchas[7,30],havebeenprovedtobevulnerabletocertainattacks\nWhilePS-basedsolutionshavebeenfrequentlydesignedandanalysed,littleeﬀorthasbeendevotedintostudyingthefeasibilityoffuzzyprimitives(asthecoreofsuchschemes)inresource-constrainedsystemsaswellashowtoconﬁgurethemtooptimiseperformance.Thisisincontrastto“traditional”cryptographicalgorithms,whoseeﬃcientimplementationonresource-constraineddeviceshasbeenwidelystudied,seee.g.,[12,25,33].1ApartfrombeingusedinPS-basedkeyexchangeprotocols,fuzzyschemesarealsousedinotherareassuchasbiometricsandPhysicalUnclonableFunctions(PUFs)[3,5,9,10],wheretraditionalcryptographicalgorithmsarenotdirectlyapplicable.\nM.Zhangetal.\n1.2Contributions\nInthispaper,wepresentimplementationsandevaluationsofPS-based128-bitkeyagreementbasedonfuzzycryptographicprimitivesonanMSP430,whichisarepresentativelow-powermicrocontrollersimilartotheoneusedincommercialIMDsorwearables.Ourmaincontributionsare:\n1.WeimplementandoptimisesixfuzzycryptographicprimitivesforPS-basedkeyexchange.Ourimplementationcanbeeasilyportedtodiﬀerentplatforms.2.Weevaluateandcomparetheresourceconsumption(energyconsumptionandcommunicationoverhead)ofeachconstructionundervariousparametersettingsbothatthetransmitterandreceiverusinganMSP430.Wedemonstratethatfuzzyprimitivesarefeasibleonaresource-constrainedembeddeddevice.Weshowhowparameterselectionaﬀectstheperformanceandreportontheoverallbest-performingfuzzyprimitivesunderdiﬀerentmetricspaces.Tothebestofourknowledge,wearetheﬁrsttoprovideasystematicevaluationsofvariousfuzzyprimitivesonresource-constraineddevices.\n3.Weimplementcountermeasuresagainsttimingattacksforthemosteﬃcientconstructions,andshowthatourprotectedimplementationsreducetimingleakagebelowthestatisticalsigniﬁcancethreshold,whileonlyminimallyaﬀectingresourceconsumption.\n", "tions,andshowthatourprotectedimplementationsreducetimingleakagebelowthestatisticalsigniﬁcancethreshold,whileonlyminimallyaﬀectingresourceconsumption.\nOursourcecodeisavailableunderthefollowinglink:https://github.com/MrZMN/FuzzyKey\nPaperorganisation.Theremainderofthispaperisorganisedasfollows:inSect.2,weintroducethemathematicalbackgroundoffuzzyprimitives,commonlyusedcomponents,andconcreteconstructionsusedinthispaper.InSect.3,weexplainoursecurityassumptionsandhowtoinstantiatetheconstructionsoffuzzyprimitives.WegiveimplementationdetailsinSect.4,beforeevaluatingtheperformanceofallfuzzyprimitivesinSect.5.WeconcludeinSect.6.\n2Background\nInthissection,wedescribethemathematicalbackgroundrequiredforthispaper,anddiscussseveralfuzzycryptographicalgorithms.ElementarycomputationsareinGF(2m).Inthispaper,weconsiderm≤8sothatcomputationsarefastonconstrainedembeddeddevicesandmostvariablesﬁtinonebyte.AmetricspaceMisaﬁniteset.ForeachM,thereisadeﬁniteintegerdistancedist(m1,m2)betweenanytwoelementsm1andm2.Thefuzzyprimitivesdiscussedinthispaperrelyontwodiﬀerentkindsofmetricspaces:(i)Hammingmetricspaceand(ii)setmetricspace.InaHammingmetricspace,M=F(cid:2)foranalphabetF.dist(m1,m2)inMistheHammingdistance,whichisthenumberofpositionsthatm1diﬀersfromm2.Forexample,forM={0,1}3,dist({0,0,0},{1,1,1})=3.Besides,thenumberofnon-zeroelementsinm1iscalledm1’sHammingweight.Inasetmetricspace,Mcontainsalls-elementsubsetsofauniverseU.dist()inMisthesetdiﬀerence,whichisthesizeofsymmetricdiﬀerence\n(deﬁnedbysymdiff(m1,m2)={x∈m1∪m2|x/∈m1∩m2}).Forexample,U=GF(23)ands=3,dist({0,1,2},{0,1,3})=2.dist(m1,m2)isanevennumberwhenthesizeofm1andm2isthesame.\n", "(deﬁnedbysymdiff(m1,m2)={x∈m1∪m2|x/∈m1∩m2}).Forexample,U=GF(23)ands=3,dist({0,1,2},{0,1,3})=2.dist(m1,m2)isanevennumberwhenthesizeofm1andm2isthesame.\nTheinputsofthefuzzyprimitivesworkingonthesetwometricsarediﬀerent.Forthispaper,theinputisthephysiologicalvalueconvertedfromaPS.ForHammingmetricmethods,theinputisabitstringthatcanbegeneratedbyconcatenatingthebitrepresentationsofPSs,suchasheartrates,whichmakesthesemethodsﬂexiblefordiﬀerenttypesofPS.However,becauseabitstringisconsecutive,thesemethodsaresensitivetodislocationanderasureerrorsonthemeasurements(e.g.,duetopeakmisdetectionwhenusingtheheartbeat[31]).OnebiterasureatthestartofabitstringmightleadtoasigniﬁcantincreaseintheHammingdistance.Setmetricmethodsalleviatetheseproblemstoacertainextent.Theinputinthiscaseisaset,andevenifthereareorder-diﬀerenceorerasureproblemsonsetelements,thesetdiﬀerencewillnotvarysubstantially.However,convertingonespeciﬁcPSintoasetwhoseelementsarerandomlydistributedinUcanbecomplicated,especiallywhenthesizeofUislarge.ErrorCorrectionCodes.ErrorCorrectionCodes(ECCs)arefrequentlyusedtoachieveerror-toleranceinthispaper.AnECCcomprisesencodinganddecodingphases.Intheencodingphase,theoriginaldataisencodedasacodeword,wheresomeformofredundancyisadded.Whenerrorsappearinthecodeword,thedecodingphaserecoverstheoriginaldataifthetotalnumberoferrorsisbelowtheerrortolerancelimit.ECCsarerepresentedbythetriple{n,k,t},wherenisthenumberofsymbolsofthecodeword,kisthenumberofsymbolsofthedata(k<n),andtisthemaximumnumberoferrorsthatcanbecorrectedinacodeword.Theerrortoleranceisthent/n.WefocusontwolinearECCs,namelybinaryBose-Chaudhuri-Hocquenghem(BCH)andReed-Solomon(RS)codes,asalreadyrecommendedintheﬁrstpapersonfuzzyprimitives[10,15,16].Theyprovideﬂexibleparameterselectionaswellaseﬃcientencodinganddecodingmethods.Aswewillshowinthenextsections,aneﬃcientECCcangreatlyimprovetheperformanceofthefuzzycryptographicalgorithms.\n", "aswellaseﬃcientencodinganddecodingmethods.Aswewillshowinthenextsections,aneﬃcientECCcangreatlyimprovetheperformanceofthefuzzycryptographicalgorithms.\n2.1FuzzyCryptographicPrimitivesforPS-BasedKeyExchangeWebrieﬂydescribeallfuzzycryptographicprimitivesevaluatedinthispaperandshowtheiruseforPS-based128-bitkeyexchange.Wedistinguishtwotypes:(i)basedonHammingdistance(fuzzycommitment,code-oﬀsetandsyndrome)and(ii)basedonsetdiﬀerence(fuzzyvault,improvedJuels-SudanandPinsketch).WedenotethetransmitterandreceiverthatagreeonacryptographickeyasTXandRX,andrefertothephysiologicalvaluesgeneratedbyTXandRXaspsandps(cid:3).Ext←−−denotesextractionofpsorps(cid:3)fromrawPSmeasurements,\nandR←−denotesrandomnumbergeneration.←−−−−−referstorandomlymixingelementsinaset,whilecalculatingtherootsofapolynomialisdenotedasroots←−−−.Wewrite(0,1)(cid:2)foran(cid:2)-bitlengthstringand{x,y}sforasetcomprisingsdistinctelements.Inallfuzzycryptographicconstructionsdescribedbelow,theﬁrststepistoextractpsandps(cid:3),whichwewillomitintherestofthissection.\nM.Zhangetal.\nFig.1.Fuzzycryptographicprimitives.\nInafuzzycommitment[16],TXgeneratesarandomkeyandencodesittoformacodeword(Fig.1a).Subsequently,TXmasksthecodewordbyXORingitwithpsandthensendstheresultingvalue(denotedbyfc)toRX.Uponreceivingfc,RXgeneratescodeword(cid:3)byXORingfcwithps(cid:3).Onlyifthemismatchratebetweencodewordandcodeword(cid:3)islessthantheECC’serrortolerancelimit,RXcansuccessfullyrecoverthekeypreviouslygeneratedbyTX.\nThefuzzyvault(Fig.1b)[15]isdesignedto“lock”akeyusingasetoffeaturesA.ItcanbeunlockedonlybyusingasetoffeaturesBthatissuﬃcientlysimilartoA.Concretely,TXgeneratesakeyandembedsitinaunivariatepolynomialp().Then,TXmixesandsendsvalidpoints(x,y),wherexisinpsandy=p(x),andinvalidpoints(alsoknownas‘chaﬀpoints’)thatdonotlieonp().Foreachreceivedpoint,RXveriﬁeswhetherxisinps(cid:3),andthenperformspolynomialreconstructionbasedonallthematchedpoints.Onlyiftheoverlapbetweenpsandps(cid:3)issuﬃcientlylarge,RXcansuccessfullyrecoverthekey.\n", "thenperformspolynomialreconstructionbasedonallthematchedpoints.Onlyiftheoverlapbetweenpsandps(cid:3)issuﬃcientlylarge,RXcansuccessfullyrecoverthekey.\nBothfuzzycommitmentandfuzzyvaulttransportakeyusingtwosimilarPSmeasurements.Incontrast,fuzzyextractors[10]extractthekeyfromthePSitself.Generally,themismatchesofPSmeasurementsatTXandRXarecorrectedbysharing“helperdata”.Afterwards,bothsidesusetheagreedPStoextractthecryptographickeywithastrongrandomextractor(e.g.,asecurehashfunction).WeconsiderfourfuzzyextractorsinHammingandsetmetrics.Weomitthekeyextractionstepbelowasitisthelaststepsharedbyallconstructions.Thecode-oﬀsetconstruction(Fig.2a)issimilartothefuzzycommitmentscheme,butherepsisthesecret,whileinfuzzycommitment,psconcealsthekey.Inparticular,TXgeneratesarandomnonceandencodesitascodewordusingtheECC.Then,TXsendsss=codeword⊕ps.RXobtainsthecodeword(cid:3)=ss⊕ps(cid:3)=codeword⊕ps⊕ps(cid:3)andcandecodeittocodewordifthemismatchrateiswithinbounds.Finally,RXrecoversps=codeword⊕ss.\nThesyndromeconstruction(Fig.2b)isbasedonsyndromedecodingofanECC.Concretely,TXandRXregardpsandps(cid:3)asacodewordandcalculate\nsyndromessynandsyn(cid:3),respectively.TXsendssyntoRX,whocalculatessyn⊕syn(cid:3).Formismatchvectormis=ps⊕ps(cid:3),syn⊕syn(cid:3)isthesyndromeofmis,whichdecodestomisifthemismatchrateiswithinbounds.Then,onerecoversps=mis⊕ps(cid:3).Comparedtocode-oﬀsetconstruction,thesyndromeisalwaysshorterthanthecodeword,reducingthecommunicationoverhead.\n", "nbounds.Then,onerecoversps=mis⊕ps(cid:3).Comparedtocode-oﬀsetconstruction,thesyndromeisalwaysshorterthanthecodeword,reducingthecommunicationoverhead.\nIntheimprovedJuels-Sudanconstruction(Fig.2c),TXusesthemonicpolyw∈ps(x−w)withrootsaselementsinpsandwritesitasthesumnomialp(x)=phigh()+plow().TXcalculatesthecoeﬃcientsofphigh()andsendsthemtoRX.Then,RXgeneratespoints(x,y)wherexisinps(cid:3)andy=phigh(x).Ifps(cid:3)≈ps,mostpointswillalsobeonplow(),soRXcanreconstructitandobtainpsbyﬁndingrootsofp().Comparedwithfuzzyvault,thecommunicationoverheadismuchlowerasonlysomecoeﬃcientshavetobesent.ThePinsketchconstruction(Fig.2d)isbasedonanECC.Foruniversesizeu=2m−1,asetsetcanbeviewedasavector{0,1}u,with1atpositionwherex∈setand0otherwise.Inthisway,psandps(cid:3)arewrittenastwosuchu-elementvectorsv,v(cid:3)whoseHammingweightisthesetsizes.TXandRXcalculatethesyndromessstxandssrxofvandv(cid:3).Afterwords,TXsendssstxtoRX,whileRXcomputessyn=sstx⊕ssrx.IfthemismatchrateisundertheerrortoleranceoftheECC,thesyndromedecodingresultofsynisthesymmetricdiﬀerencebetweensetspsandps(cid:3),whichhelpscorrectthemismatches.Becausevandv(cid:3)arebinaryvectors,BCHcodesareparticularlysuitable[10].\nFig.2.Fuzzyextractorconstructions.\nM.Zhangetal.\n3DesignSecurityandParameterSelection\nToprovideasystematiccomparisonandevaluationoffuzzyprimitivesforPSbasedkeyexchangeonresource-constrainedembeddedsystems,wemakeseveraldesigndecisions:Takingintoaccountthelimitsonenergyconsumptionandcomputationalresourcesinabody-areanetworkscenarioandthefactthatkeysareoftenshort-lived,welimitourselvesto128-bitkeys.Furthermore,weonlyconsiderkeyexchangebetweentwodevices.Wenotethatsubsequentprotocolsteps,suchaskeyconﬁrmationsteptoensurethatTXandRXderivethesame128-bitkey,areindependentoftheunderlyingfuzzyprimitiveandhencedonotconsiderthosesteps.WealsonotethatfuzzyprimitivesareonlyresponsibleforcorrectingthemismatchesofthePS,i.e.,wedonotconsidererrorsonthewirelesschannel,andassumethattheunderlyingwirelessprotocolincludesappropriateerrordetectionandcorrectionmeasures.\n", "hePS,i.e.,wedonotconsidererrorsonthewirelesschannel,andassumethattheunderlyingwirelessprotocolincludesappropriateerrordetectionandcorrectionmeasures.\nAdversaryModel.WeconsiderastrongadversarywhoknowsalldetailsabouttheusedfuzzyprimitivesandhasfullaccesstothecommunicationchannelbetweenTXandRX.Theadversarycan(i)performpassiveattacksbyeavesdroppingonthecommunicationandexploitinginformationleakagefromit.Forexample,ifpsandps(cid:3)inafuzzycommitmentarelow-entropy,theadversarycanstatisticallyanalysetheirdistributionandthuscompromisethesecurity[27].Alternatively,correlation-basedmethodsthatleveragethecorrelationbetweencommunicationdataovermultiplekeyexchangesessionscanbeused[17].Ontheotherhand,theadversarycanalso(ii)carryoutactiveattacks,i.e.,actasMan-In-The-Middle(MITM)orreplayoldsessions.Finally,theadversarycanalsoobserveandexploitsecret-dependenttimingleakagee.g.,theprecisetimebetweentwoprotocolmessages,bothinpassiveandactiveattacks.WeassumethatthemeasuredPScannotbemodelledorpredictedandcannotberemotelyobtained.Thelatterimpliesthatadversarycanbeinproximitytotheuserbutcannottouchhimdirectlyorindirectly(becausethiswouldallowtheadversarytomeasurethesignal),norbeingabletocompromiseadevicewornbytheusertomeasurethePS.Intheresearchcommunity,thistouch-toaccessaccesscontrolmodeliswidelyacceptedasitoﬀersareasonabletradeoﬀbetweensecurityandavailability[24,30].Althoughthesecuritymayrelyonuserawarenesstosomeextent,thismodelensureshighavailabilityinemergencysituationswherefastestablishmentofasecurechanneltotheIMDisvital.Forthisreason,weleavephysicalside-channelandotherattackswithdirectaccess(suchasfaultinjection)outoftheadversarymodel,asinthiscase,theadversarycanequallymeasurethePSdirectlyforkeyrecovery.WealsodonotconsiderDenial-of-Service(DoS)attackssuchasjammingorbatterydepletionattacks.\n", "case,theadversarycanequallymeasurethePSdirectlyforkeyrecovery.WealsodonotconsiderDenial-of-Service(DoS)attackssuchasjammingorbatterydepletionattacks.\nCountermeasuresAgainstPassiveAttacks.Theunderlyingsecurityofthefuzzycommitmentagainstoﬄineattacksdependsontheentropyofthebitstringspsandps(cid:3)extractedfromPSastheseareusedtoconcealthekey(byXOR)whilebeingtransported.Thesecurityoffuzzyvaultreliesonthefactthattheadversarycannotdistinguishbetweenvalidandchaﬀpoints,andhenceisunabletoreconstructp().Forafuzzyvaultschemewithparametersg,bandd(cf.\nFig.1b),theadversarywouldneedanaverageoftorevealp()(assumingthatBerlekamp-Welchdecodingisused).Therefore,thenumberofchaﬀpointsneedstobesuﬃcientlylarge.\nForfuzzyextractors,thesecuritydependsontheentropyofthePSitselfasthekeyisdirectlyextractedfromthePS.Duetotheleakageofhelperdata,therewillbeanamountofentropylossonPSineachconstruction.Forcode-oﬀsetandsyndromeconstructions,theentropylossis(n−k)·f,wheren,kcomefromtheunderlying(n,k,t)ECC,andfisthenumberofbitsconstitutingeachsymbol.Theentropylossist·log2ufortheimprovedJuels-Sudanconstruction,andist·log2(u+1)forthePinsketchconstruction,whereuistheuniversesizeandtisthemaximumsetdiﬀerencebetweenpsandps(cid:3).Notethattheaboverepresentworstcaseentropylossvalues[10].Someofthemwerealsoproventobeoverlypessimistic[9].Toensuresecurity,weregardtheworst-casevaluesastheactualentropylossinthispaper.Becauseweonlyfocuson128-bitkeyagreement,iftheremainingentropyofPS(theagreedPSbeforeinputtothestrongextractor)is≥128bit,thefuzzyextractorisconsideredsecure.\nForcorrelation-basedattacks,notethatinthecaseofPS-basedkeyexchange,thePShastovaryovertimeandtheexchangedkey(generatedrandomlybythedeviceorextractedfromthePS)isshort-livedanddiﬀerentineachsession[20],unlikescenariosbasedonnon-variablematerials,e.g.,biometricsorPUFs.Thismeansthatcorrelationattacksarepreventedbythenatureoftheapplication.\n", "session[20],unlikescenariosbasedonnon-variablematerials,e.g.,biometricsorPUFs.Thismeansthatcorrelationattacksarepreventedbythenatureoftheapplication.\nCountermeasuresAgainstActiveandTimingAttacks.Duetothevaryingkey,replayattacksarebydesignprevented.Otheractiveattacks(suchasguessingbasedones)requiretheadversarytobreakthefuzzyprimitive“online”withinasingleprotocolsession[4,18],otherwise,theyatmostresultinfailureofthekeyexchangeandaredetectedbysubsequentkeyconﬁrmation.Theycanthusbepreventedbygeneratingasecretwithsubstantiallyhighentropy.ActiveattacksbasedonaccuratemeasurementormodellingoftheunderlyingPS[6]areoutsideouradversarymodel.Timingattackscanbegenericallypreventedusingconstant-timeimplementationstechniques,whichwefurtherdiscussinSect.4.AssumptionsonPhysiologicalSignal.TheselectionofthePS(e.g.,IPI)anditsqualityasanentropysource,althoughanimportantissue,areoutofthescopeofthispaper.However,wewouldliketostressthatthequalityofPSonlyaﬀectsthetotalmeasurementtime,e.g.,alowerqualityoftheentropysourcemeanslongermeasurements.Inordertogeneratetheinputforthefuzzyprimitives,asetofpre-processingmethods(e.g.,quantisationandcoding[26])isappliedtotherawPSmeasurements.However,thisisoutofthescopeofthispaper.\nAssumptionsonFuzzyPrimitiveInput.Theinputsoffuzzyprimitives(i.e.,psandps(cid:3)inSect.2.1)areextractedfromsomePSwhichismeasuredbytwodevicessimultaneously.Thereareseveralfactorsthataﬀectthesimilarityofpsandps(cid:3),e.g.,thetypeofPS,themeasurementaccuracyofthesensor,andthesignalprocessingmethod.Toevaluateandcomparediﬀerentfuzzyprimitives,it\nM.Zhangetal.\nisnecessarytoconsiderpre-deﬁnedmismatchrates(i.e.,percentageofdiﬀerentbits/setelements)betweenpsandps(cid:3),whichreﬂectthecharacteristicsofdiﬀerentkindsofscenarios.Inthispaper,weconsiderthreemismatchthresholdsof2%,5%and10%.Whiletheauthorsof[39,40]reportedthatthemismatchrateforheartratemeasurementsistypicallybelow5%,wenotethatotherPSsmighthaveslightlyhighermismatchthresholds.WealsonotethatunlikeBCHcodes,RScodesaremulti-bit-symbolbased.Thus,forRScodevariants,theabovethresholdsindicatethepercentageofdiﬀerentsymbolsratherthanbits.Additionally,oneshouldnotethattheaveragebiterrorrate(i.e.,thepossibilitythateachbitdiﬀersfortwobitstrings)maybemorebroadlyusedontheHammingmetricinotherapplicationscenarios,thus,wealsoprovidethisinformationforeachvariantinTable2(withamaximumtolerablefailurerateof10−6).Thismaximumaveragebitratethatcanbetoleratedneedstobeconsideredwhenselectingthemostappropriateerrorcorrectingcode.\n", "amaximumtolerablefailurerateof10−6).Thismaximumaveragebitratethatcanbetoleratedneedstobeconsideredwhenselectingthemostappropriateerrorcorrectingcode.\nHere,weassumethatpsandps(cid:3)are(cid:2)-bitstringsthatarerandomanduniformlydistributedforHammingmetricmethods,orsetscontainingsdistinctelementsthatareuniformlydistributedinauniverseUforsetmetricmethods.Thisassumptionisonlymadeforfairlycomparingdiﬀerentfuzzyprimitives;bothfuzzycommitmentandfuzzyvaultnaturallyrequiretheinputtobeuniformlyrandomlydistributedtoensuresecurity.2Additionally,ifthefuzzyprimitiveinputsarenotuniformlydistributed,itishardtoquantifytheentropylevelofthePSandestablishauniﬁedmismatchratethreshold.Underthisassumption,theinitialentropyofthePSis(cid:2)forHammingmetricfuzzyextractors,whileforsetmetricfuzzyextractors,itislog2withuthesizeofU.\nParameterSelection.Themismatchratebetweenpsandps(cid:3)directlydeterminestheerrortolerancerequirementofthefuzzyprimitives.ForHammingmetricmethods,theerrortoleranceisthesameasthatoftheunderlyingECC(i.e.,t/nforan(n,k,t)code).Forexample,(50,44,1)and(20,15,1)BCHcodesaresuitablewhenthemaximummismatchrateis2%and5%,respectively.However,RScodescannotprovideexact2%,5%and10%errortolerancebecauseoftheirinherentstructure.Therefore,weselectedseveralRSconstructionswitherrortolerancewithin2%+thepre-deﬁnedmismatchratethresholds.Forexample,theerrortoleranceofa(31,29,1)RScodeis3.23%.AsmentionedinSect.2,allcodesstaywithintheﬁeldGF(28).Forsetmetricmethodswith(u,s,t)structure,whereuistheuniversesize,sthesetsizeandtthemaximumtolerablesetdiﬀerencebetweenpsandps(cid:3),theerrortoleranceist/2s.\nForeachfuzzyprimitive,therecanbemultiplefeasibleparameterchoicesunderthesamemismatchrate,e.g.,usingdiﬀerentconﬁgurationsofECCsmayachievethesameerrortolerance.Thediﬀerencebetweenthemisthattherepetitioncountmightbediﬀerent:Assumethetotalrepetitioncountisrandthenumberofsecretbitsdistributedineachiterationisi,weneedtoensurethatr·i≥128toachieve128-bitsecurity.Thisway,RXconcatenatesthesecret\n", "titioncountisrandthenumberofsecretbitsdistributedineachiterationisi,weneedtoensurethatr·i≥128toachieve128-bitsecurity.Thisway,RXconcatenatesthesecret\n2However,thisrequirementcanbealleviatedwiththecombinationofaPasswordAuthenticatedKeyExchange(PAKE),asshownin[18].Notethatfuzzyextractorscanstillbesecurelyusedeveniftheinputsarenotuniformlydistributed.bitsitreceivesineachiterationtoformthe128-bitkey.Thesecurityofsubsequent/parallelexecutionbasedonlinearcodeshasbeenprovenin[9].Notethatiisthelengthofthekeydistributedperiterationforfuzzycommitmentandfuzzyvault,buttheremainingentropyofPSforfuzzyextractors.Considerafuzzycommitmentthatisbasedon(50,44,1)and(200,168,4)BCHcodes(bothhandlemismatch≤2%)asanexample.Inordertodistributea128-bitkey,theformervariantneedstobeexecutedthreetimes(3·44>128),whilethelatteronlyneedstobeexecutedonce.Althoughmoreiterationsmayberequired,smallparameterchoices(e.g.,anECCwithasmallblocksize)almostalwaysmeanlesscomputationandhencelessenergyconsumption.Therefore,wetestdiﬀerentvariantsunderthesamemismatchthreshold.Avariantwithlargerparameterchoiceisconsideredonlyifitreducesthenumberofrequirediterations.Besides,undereachmismatchrate,thevariantsusedbydiﬀerentfuzzyprimitivesineachmetricarethesame,thushelpwiththeperformancecomparison.\nNotethatforHammingmetricmethods,thenumberoffeasiblevariantsdependsonthenumberofunderlyingECCsthatachievethepre-deﬁnedmismatchthresholds.WegiveallfeasiblevariantsforHammingmetricinTable2.Forsetmetricmethods,therearemorepossible(u,s,t)variantsbecause(i)theuniversesizeucanvarydependingonhowaPSisconvertedtoasetand(ii)multiplesandtcombinationscanachievethesameerrortolerance.Inthispaper,weuseu=255,whichisthemaximumuniversesizeforthePinsketchconstructiononGF(28).Wedeﬁnethreevariants(255,50,2),(255,20,2)and(255,10,2)for2%,5%,and10%mismatchratethresholds.Thesevariantsareprovidedforreferenceonly,andonecoulddevisemoreappropriatevariantsforsetmetricswithspeciﬁcmappingsfromPStoset.Finally,thefuzzyvaultconstructionoverGF(28)isinsecure,becausethenumberofchaﬀpointsis≤28.However,forourperformanceevaluationinSect.5,welimitourselvestoGF(28),andnotethatthesystemcanbeeasilyextendedtolargerﬁelds(e.g.,GF(216)).\n", "ﬀpointsis≤28.However,forourperformanceevaluationinSect.5,welimitourselvestoGF(28),andnotethatthesystemcanbeeasilyextendedtolargerﬁelds(e.g.,GF(216)).\n4ImplementationWeimplemented,ran,andmeasuredallalgorithmsonaTIMSP430FR5969LaunchPaddevelopmentboard[35].Thisboardcomprisesa16-bitmicroprocessorwith2kBvolatileSRAMand64kBpermanentFRAM,whichisrepresentativeforlow-powerbodyareanetworkdevices(includinge.g.,IMDs).WealsoalternativelyusedanMSP430FR5994developmentboard[36]with8kBSRAMforcertainvariantsthatrequiremoreresources,andindicatethisinTable2.Fordevelopment,weusedTI’sCodeComposerStudioasitprovidesintegratedfunctionalityforon-deviceenergyconsumptionmeasurement.\nImplementationoftheStrongExtractor.Consideringmanyembeddedmicrocontrollers,includingtheMSP430usedinthispaper,featureahardwareAESaccelerator,weoptedtouseablockcipher-basedhashfunction,withAESastheunderlyingcipher.WeselectedtheHiroseconstruction[13]forthestrongextractorinourimplementation.Hiroseisadouble-block-lengthhashwithMerkleDamg˚ardstructure.WemeasuredtheaverageenergyconsumptionofeachinvocationoftheHirosecompressionfunctiononMSP430FR5969tobe1.42µJ.\nM.Zhangetal.\nDependingontheavailabilityofafasthardware/softwareimplementation,otherhashfunctionssuchasSHA256canbeusedinsteadofHirose.\nSoftwareDevelopmentandEnergyMeasurement.WeimplementedallalgorithmsinplainCandmainlyreliedonstandardClibrariessothatourimplementationcanbeeasilyportedtootherplatforms.Forrandomnumbergenerationandhardware-acceleratedAES,weusedTI’sdriverAPIs.Thetestedaverageenergyconsumptionofgenerating16byteswhenusingTI’srandomnumbergeneratorAPIis2.5µJ.Certaincomponentscanbeimplementedindiﬀerentways.Forexample,thereareavarietyofalgorithmsforECCs.Wechosecommonlyused,eﬃcientalgorithms:forBCHandRSencoding,weusedstandardcycliccodeencoding,andfordecodingweusedtheBerlekampdecodingmethod[2,19].Forpolynomialreconstruction,weusedtheBerlekamp-Welchalgorithm.\n", ",weusedstandardcycliccodeencoding,andfordecodingweusedtheBerlekampdecodingmethod[2,19].Forpolynomialreconstruction,weusedtheBerlekamp-Welchalgorithm.\nWecarriedouttheenergyconsumptionmeasurementusingTIenergyTracetool.Thisfunctionalityallowstotakeaccurateon-deviceenergymeasurementfromtheCodeComposerStudioIDE.Foreachmeasurement,weaveragedtheenergyconsumptionvalueover100executionsoftherespectivealgorithm.Totesttheerrorcorrectionabilityofthefuzzyprimitives,weartiﬁciallyaddedthemaximumtolerablenumberofmismatchesonthePSinthecode,andthenmeasuredthecorrespondingenergyconsumption.WeusedTIUltraLowPowerAdvisortooltorefactorourcodeandminimiseenergyconsumption.Overall,wefoundthattheseoptimisationsreducedtheenergyconsumption≤10%.EstimationofCommunicationEnergyCost.Theenergyconsumptionofaprotocolbetweenmultipledevicescomprisestwocomponents:(i)theenergyconsumptionofcomputations;and(ii)theenergyconsumptionofwirelesscommunication.Inthispaper,weonlymeasuretheenergyconsumptionofcomputation,andmodelthecostofwirelesscommunicationbasedonthenumberofbitstobetransmittedandreceived.Inparticular,inSect.5,weusetheexperimentalresultsof[25]foraTelosB[8],awirelesssensornodebasedona16-bitMSP430microcontrollerandaCC2420transceivertoillustratetheimpactofcommunicationoverheadonoverallenergyconsumption.Theirresultsshowthatfor75kbpsdatarateand−5dBmtransmitpower,theaverageenergyrequiredtotransmitonebitofeﬀectivedatais0.72µJ,andtheenergyrequiredtoreceivethisbitis0.81µJ.\nWeacknowledgethatasimplistic“energy-per-bit”modelmaybeinadequatee.g.,whenusingpacket-basedprotocolssuchasBluetoothLowEnergy(BLE)3,wheretheconstantoverheadsduetotheframestructureandothersteps(e.g.,wakeupandpreparation)canbesubstantial.Therefore,wealsoprovidethenumberofpayloadbitsforeachvariantinTable2,whichcanbefedintoamoreappropriateenergyconsumptionmodelforaspeciﬁcwirelessprotocol(e.g.,informedbymeasurementsasreportedin[34]).Wenotethatmanywidelyusedprotocolssupportpayloadslargeenoughtoaccommodateallourvariantsinonepacket(e.g.,246bytesforBLE).Thisminimizestheimpactoftheframe\n", "notethatmanywidelyusedprotocolssupportpayloadslargeenoughtoaccommodateallourvariantsinonepacket(e.g.,246bytesforBLE).Thisminimizestheimpactoftheframe\n3BLEisalreadybeingusedincommercialIMDse.g.,MedtronicAzurepacemakers[1].structure,thus,whenconsideringsuchprotocols,thediﬀerentimplementationscanbecomparedpurelybasedontheircomputationalenergycost.\nDefensesAgainstTimingSideChannels.Weimplementedcountermeasuresagainsttiming-basedside-channelattacksonthebest-performingvariants(i.e.,fuzzyprimitiveswithlowesttotalenergyconsumptionunderdiﬀerentmismatchthresholds,cf.Table4).Wefoundthatnon-constantexecutiontimemainlyarisesintheECCencoding/decodingprocessesthroughvariousconditionalbranchesdependingonavaluebeingnegative.Toaddressthis,wereplacedallsuchconditionalbrancheswithBooleanoperators,andusedotherconstant-timeimplementationtechniques,suchasconstant-timemoduloreduction(basedonBarrettreduction)andconstant-timesorting.\nTable1.Eﬀectsoftimingside-channeldefensesontimingleakage(measuredbyWelch’st-test)andenergyconsumption.\nFuzzyprimitive\nt-valueEnergy(mJ)\nUnprotected\nt-valueEnergy(mJ)t-valueEnergy(mJ)\nUnprotectedt-valueEnergy(mJ)\nSyndromeextractor(31,29,1)RS\nSyndromeextractor(31,27,2)RS\nSyndromeextractor(63,49,7)RS\nPinsketchextractor\n(255,50,2)\nPinsketchextractor\n(255,20,2)\nPinsketchextractor\n(255,10,2)\nWeempiricallyveriﬁedtheeﬀectsofimplementingtheabovecountermeasures,includingtheeﬀectontimingleakageandenergyconsumption(communicationoverheadincluded).Weuseddudect[28]toevaluatethetimingleakageoftheTXandRXimplementationsrunningontheMSP430FR5969.TheresultsaregiveninTable1.ThetimingleakageofaprogramisevaluatedbyWelch’sttestindudect.ForeachTXandRXimplementation,thet-valueinTable1wascomputedusing10,000timingmeasurements.Forat-value≤10,dudectregardsthetimingleakageasinsigniﬁcantgiventhenumberoftimingmeasurements.\n", "t-valueinTable1wascomputedusing10,000timingmeasurements.Forat-value≤10,dudectregardsthetimingleakageasinsigniﬁcantgiventhenumberoftimingmeasurements.\nItisevidentthatthebaselineimplementationsexhibitstrongtimingleakage,whiletheprotectedvariantssigniﬁcantlyreducetheleakagebelowtheconstanttimethresholdofthet-testindudect.Besides,theenergyconsumptionisnotsigniﬁcantlyincreasedfortheprotectedvariants.Infact,insomecasestheenergyconsumptionevendecreasesbecauseoftheuseofBarrettreduction,whichreplacesthecostlymodulooperationotherwiseimplementedthroughdivision.5PerformanceEvaluation\nWeimplemented22variantsoffuzzyprimitivesintotalfortheHammingmetricandthreeforthesetmetric.Foreachvariant,wemeasureditscomputationalenergyconsumptionandestimatedthecommunicationcostatbothTXandRXsides,andgivetheinputsize(extractedfromthePS)requiredtoachieve128-bitsecurity.Table3showsthemainbuildingblocksusedbyeachfuzzyprimitive.\nTable2.EvaluationofHammingandsetmetricmethods\nMax.averagebiterrorrate\n#iterations\nPSdata(bit)\n(50,44,1)BCH(100,86,2)BCH(200,168,4)BCH(31,29,1)RS(20,15,1)BCH(40,28,2)BCH(60,42,3)BCH(80,52,4)BCH(100,65,5)BCH(220,136,11)BCH(15,13,1)RS(31,27,2)RS(10,6,1)BCH(20,10,2)BCH(30,15,3)BCH(40,16,4)BCH(50,23,5)BCH(60,27,6)BCH(90,34,9)BCH(120,43,12)BCH(210,70,21)BCH(63,49,7)RS\nFuzzyvault\nFuzzycommitment\nCode-oﬀsetconstruction\nSyndromeconstruction\nImprovedJuels–Sudanconstruction\nPinsketchconstruction\n", "210,70,21)BCH(63,49,7)RS\nFuzzyvault\nFuzzycommitment\nCode-oﬀsetconstruction\nSyndromeconstruction\nImprovedJuels–Sudanconstruction\nPinsketchconstruction\n#iterations(255,50,2)(255,20,2)(255,10,2)\n#iterations\n#iterations\nTable2showsthedetailedmeasurementresultsforallconsideredfuzzyprimitiveinstantiationsinboththeHammingandsetmetric.Weincludethefollowingcharacteristicsofeachvariant:errortolerance,maximumaveragebiterrorrate,requirednumberofiterationstoachieve128-bitsecurity,computationalenergycostatTX/RX(excludingcommunicationcost),communicationoverhead(inbitstransmitted/received),andrequirednumberofbitsextractedfromthePS.∗indicatesimplementationonMSP430FR5994duetomemoryrequirements.\nInthefollowing,wefocusontheevaluationandcomparisonofselectedvariants.Weincludefull,detailedresultsforallvariantsinTable2.Asmentioned,webaseourestimationofcommunicationcostsonthevaluesof0.72µJperbitforTXand0.81µJforRX[25],butalsoprovidethenumberofexchangedpayloadbitsforusewithothermodelstoestimatecommunicationenergy.\n5.1HammingMetricConstructions\nTheminimumnumberofinputbitsderivedfromthePSisgivenasn·f·r,wherenisthecodewordlengthofthechosenECC,fisthenumberofbitsconstitutingasymbol,andristhenumberofrepetitions(i.e.,howmanyiterationsoftheprimitivearerequiredfor128-bitsecurity).Dependingonthespeciﬁcvariant,between150and420PS-derivedbitsarerequired(cf.Table2).However,aswefocusonthefuzzyprimitiveitself,ratherthantheconversionfromPStothealgorithminput,weprovidethesevaluesforreferenceonlyandtoguidedeveloperdecisionsinspeciﬁcsituations.\nTable3.MainbuildingblocksoffuzzyprimitivesforTXandRX.\nFindpoly.\nGen.points\nFuzzycommitmentFuzzyvaultCode-oﬀsetextractorSyndromeextractorImprovedJSextractorPinsketchextractor\nReconstruct\nGen.points\nFuzzycommitmentFuzzyvaultCode-oﬀsetextractorSyndromeextractorImprovedJSextractorPinsketchextractor\n", "extractorPinsketchextractor\nReconstruct\nGen.points\nFuzzycommitmentFuzzyvaultCode-oﬀsetextractorSyndromeextractorImprovedJSextractorPinsketchextractor\nComputationCosts.Fig.3showstheenergycostoftheHammingmetricfuzzyprimitives.Foreachmismatchthreshold,weshowfourvariantsofeachfuzzyprimitiveandnotethattheyareadequatetoindicatetheoveralltrend.AtTXside,weobservethatthefuzzycommitmentconsumestheleastenergy.ThecostM.Zhangetal.\nofthecode-oﬀsetextractorisgenerallyslightlyhigherthanthefuzzycommitmentunderdiﬀerentmismatchrates.Thisresultisinlinewithourexpectations,becausethecode-oﬀsetextractorcanbeseenasafuzzycommitmentwithadditionalinvocationofastrongextractor.Thesyndromefuzzyextractorinvolvesthemostenergy-intensivecomputations.ThisisbecausesyndromegenerationforBCHandRScodesisanexpensiveoperationthatinvolvesrepeatedlyevaluatingp(x)givenx,whichrequiresanumberofiterativeoperations.\nAtRXside,wenotethattheenergyconsumptionofthefuzzycommitmentisalsothesmallest.Thediﬀerenceincomputationalenergyconsumptionbetweenthecode-oﬀsetandsyndromeextractorsisoftensmallbecausebothextractorsshareseveralbuildingblocks.Notethat,evenifthesyndromeextractorhasanextra“syndromegeneration”blockcomparedtothecode-oﬀsetextractor(cf.Table3),theactualexecutionoftheseconstructionsisequivalent.\nRegardingECCchoice,theRScodeperformssubstantiallybetterthanBCHformismatchratesbelow5%.However,for10%mismatch,thechosenRScodeisworsethanthebestBCHvariant.However,notethate.g.,the(63,49,7)RSinstancecanaccommodateupto343-bitdistributionperiterationforthefuzzycommitment,whileweonlyrequire128bits,whichisnotoptimalifonlyconsideringcomputationalenergyconsumption.\nFig.3.EnergyconsumptionofHammingmetricprimitives.\nCombinedComputationandCommunicationCost.Whenwealsotaketheestimatedcommunicationcostsintoaccount,thesyndromefuzzyextractoroutperformstheothertwovariantsmostofthetime.Forbothfuzzycommitmentandcode-oﬀsetconstruction,thecommunicationoverheadisdeterminedbythecodewordlengthnofthechosenECCandthenumberofrequiredrepetitions.Forexample,considerthe(50,44,1)BCHvariantinTable2.Inthiscase,thecommunicationoverheadis50·3bits,becausethevariantneedstobeexecutedthreetimestoestablisha128-bitkey.Incontrast,thecommunicationoverheadforthesyndromeextractordependsonthesyndromelengthandthenumberofrepetitions.Thelengthofthesyndromeis2·t·mforBCHandRScodes,wheremcomesfromGF(2m)underlyingtheECC[19].Anobviousadvantageisthat\n", "dromelengthandthenumberofrepetitions.Thelengthofthesyndromeis2·t·mforBCHandRScodes,wheremcomesfromGF(2m)underlyingtheECC[19].Anobviousadvantageisthat\nthesyndromeisalwaysshorterthanthecodeword.Consideringthepreviousexample,TXwouldonlyneedtotransmit12·3bitsforthesyndromeextractor.Overall,thevariantswithlowestcombinedcomputationandcommunicationcostundereachmismatchrateareshowninTable4.Thesyndromeextractorhasvariantswiththelowesttotalenergyconsumptioninallconditions.Table4.FuzzyprimitiveswithlowesttotalenergycostontheHammingmetric(Syndromeextractor)andsetmetric(Pinsketchextractor).\nMismatchrate\nFuzzyprimitive\nTotalenergyatTX(mJ)TotalenergyatRX(mJ)\nSyndromeextractor\n(31,29,1)RS\nSyndromeextractor\n(31,27,2)RS\nSyndromeextractor\n(63,49,7)RS\nPinsketchextractor\n(255,50,2)\nPinsketchextractor\n(255,20,2)\nPinsketchextractor\n(255,10,2)\n5.2SetMetricConstructions\nTherequirednumberofderivedbitsforsetmetricmethodsiss·f·r,wheresisthesetsize,fisthenumberofbitsconstitutingasetelement,andristhenumberofrepetitions.Setmetricconstructionsrequireinputsizesfrom160to400bits(cf.Table2),whichissimilartotheHammingmetricvariants.\nComputationCosts.Figure4showstheenergyconsumptionofallconsideredsetmetricmethods(cf.Table2fortheunderlyingdata).AtTX,weobservethatthefuzzyvaultconsumessubstantiallymoreenergythantheothertwomethods.ThisislikelybecauseTXofthefuzzyvaulthastogenerateandshuﬄealargeamountofpoints(mostlychaﬀpoints).TheTXenergycostofthePinsketchfuzzyextractorisslightlybelowimprovedJuels-Sudan.AccordingtoTable3,thediﬀerenceinenergyconsumptionisduetothediﬀerencebetweensyndromegeneration(notethatthisisnotthesameasthestandardsyndromecalculationofBCHandRScode)andthepolynomialcoeﬃcientﬁnding.\n", "nisduetothediﬀerencebetweensyndromegeneration(notethatthisisnotthesameasthestandardsyndromecalculationofBCHandRScode)andthepolynomialcoeﬃcientﬁnding.\nOntheRXside,weﬁndthatthePinsketchconstructionhasthelowestenergyconsumptionformismatchratesbelow5%,andhasslightlyhigherconsumptionthanfuzzyvaultfor10%mismatch.TheimprovedJuels-Sudanfuzzyextractorisalwaysthemostexpensiveconstructionunderallmismatchrates,likelyduetotherequiredpolynomialrootﬁndingprocess.Wefurtherobservethattheenergyconsumptionofthismethodandthefuzzyvaultdecreasesigniﬁcantlywhenthemismatchratethresholdincreases.Thisisexpectedbecausebothmethodsrelyonthesamecomplexpolynomialreconstructionformismatchcorrection.Thisinvolvesoperationsons×smatrices(sisthesetsize).Hence,polynomialreconstructioniseﬃcientforsmallsets(i.e.,underhighermismatchthreshold),butasthesetsizeincreases,thecomputationalcomplexityincreasesquadratically.M.Zhangetal.\nFig.4.Energyconsumptionofsetmetricprimitives.\nCombinedComputationandCommunicationCost.Thenumberoftransmittedbitsforthefuzzyvaultisnp·lp·r,wherenpisthetotalnumberofpoints(validandchaﬀpoints),lpisthelengthofeachpoint,andristherepetitioncount.Forouruniversesizeof255,np=255andlp=16bits(eachcoordinateisonebyte).Incontrast,thetransmissionsizeforimprovedJuels-SudanandPinsketchfuzzyextractorsist·f·r,wheretisthemaximumtolerablesetdiﬀerencebetweensetsandfisthenumberofbitsconstitutingasetelement(inourconstructionsf=8).Hence,thecommunicationcostofthefuzzyvaultismuchhighercomparedtoimprovedJuels-SudanandPinsketch.TheoverallbestsetmetricvariantsforeachmismatchthresholdareshowninTable4.ThePinsketchfuzzyextractorperformsbestintermsofcombinedcomputationandcommunicationcostinallcases.TheimprovedJuels-SudanhasextremelyhighcomputationcostinRX,whilethefuzzyvaultincurssubstantialcommunicationoverhead.ConsideringthatsecureimplementationoffuzzyvaultrequiresoperationsoverGF(216)andtransmitsmorepoints,itislikelythatcostswouldfurthergrowinpractice.\n", "ead.ConsideringthatsecureimplementationoffuzzyvaultrequiresoperationsoverGF(216)andtransmitsmorepoints,itislikelythatcostswouldfurthergrowinpractice.\n5.3CommonObservationsandComparisonwithCurve25519Weobservedcertaincommontendenciesforallfuzzyprimitives:foreachvariant,thecomputationenergyconsumptionforRXisgenerallyhigherthanforTX.Conversely,thecommunicationcostisroughlythesameforTXandRX.ThisobservationisrelevantwhenassigningTX/RXrolesinmorecomplexprotocols;e.g.,alow-powerIMDcanactasTXifthegoalistominimiseenergyconsumption.Inaddition,theenergyconsumptionofvariantswithlargerparameter(e.g.,largerBCHcode)showsanincreasebothforTXandRX,eventhoughthenumberofrequiredrepetitionsdecreases.\nWecomparedtheenergycostofourbest-performingvariantswithCurve25519,oneofthemosteﬃcientellipticcurve-basedkeyexchangeschemesforembeddedsystems.Asreportedin[12],onefullexecutionofCurve25519onMSP430FR5969costsabout0.012mJ(0.404mJifcommunicationenergyisestimatedasinthispaper).Thus,ourmethodsarecomparableintermsoftotalenergyconsumption.Moreover,fuzzyprimitivesprovidesecurityguarantees\nbeyondapublic-keyschemesuchasCurve25519:theycandefendagainstMITMattacks(withoutcertiﬁcateinfrastructure)andguaranteethatRXandTXareinphysicalproximity.\n6Conclusion\nInthispaper,wesystematicallyandfairlyevaluatetheperformanceoffuzzycryptographicprimitivesforPS-basedkeyexchangeundercontrolledconditionsonaresource-constrainedMSP430microcontroller.Weshowhowdiﬀerentfuzzyprimitivescanbesecurelyappliedtoderivea128-bitkeyfromjointmeasurementsofaPS,andprovideimplementationsofeachoftheseprimitivesinmultiplevariants.Toourknowledge,wearetheﬁrsttocomparethecomputationandcommunicationenergyconsumptionofdiﬀerentfuzzyprimitivesforavarietyofparameterchoices.Amongallconsideredfuzzyprimitives,weﬁndthatSyndromeandPinsketchfuzzyextractorsoveralloﬀerthelowestenergyconsumptioninHammingandsetmetricspaces.\n", "oices.Amongallconsideredfuzzyprimitives,weﬁndthatSyndromeandPinsketchfuzzyextractorsoveralloﬀerthelowestenergyconsumptioninHammingandsetmetricspaces.\nThisindicatesthatfuzzycommitmentandfuzzyvaultusedinpreviousPSbasedkeyexchangesolutions[4,7,14,37,38]arenotoptimalonconstraineddevices.Instead,Syndrome/Pinsketchfuzzyextractorsmaybepreferable,withtheaddedadvantagethattheyneitherrequirerandomnumbergeneration,whichcanbecostlyonembeddedsystems,noruniformlyrandomlydistributedinputsderivedfromaPS.Theseconstructionsconsumebetween0.021mJand0.198mJforTXandbetween0.029mJand0.380mJforRX,includingcomputationalandcommunicationenergy.ThisdemonstratesthatPS-basedkeyexchangemethodsusingfuzzyprimitivesarefeasibleforaresource-constraineddevice,evenifkeysarerelativelyfrequentlyexchanged.WealsoobservethatECCswithsmallerparameterchoicesinfuzzyprimitiveshavegenerallybetterperformance,evenifmorerepetitionsarerequired.However,thismightcomeatthecostofhavingmorestrictconstraintsonthemaximumaveragebiterrorrateofaPS.Ourworkservesasareferencewhenapplyingfuzzyprimitivesforbody-areanetworksandmedicaldevices,andforotherusecasessuchasbiometricsorPUFs.Acknowledgements.ThisworkisfundedinpartbytheEuropeanUnion’sHorizon2020ResearchandinnovationprogramundergrantagreementNo.826284(ProTego),theFWO-SBOprojectSPITE,andbytheEngineeringandPhysicalSciencesResearchCouncil(EPSRC)undergrantEP/R012598/1.MoZhangisfundedbythePriestleyPhDScholarshipprogramme.TheECCdecodingmethodswerebasedinpartonthesourcecodeofSimonRockliﬀ[2].\nReferences\n1.MedtronicAzurepacingsystem.https://europe.medtronic.com/xd-en/healthcare\nprofessionals/products/cardiac-rhythm/pacemakers/azure.html\n2.SimonRockliﬀ’sReed-Solomonencoder/decoder.http://www.eccpage.com/rs.c3.Abidin,A.,ArgonesR´ua,E.,Peeters,R.:Uncouplingbiometricsfromtemplates\n", "e.html\n2.SimonRockliﬀ’sReed-Solomonencoder/decoder.http://www.eccpage.com/rs.c3.Abidin,A.,ArgonesR´ua,E.,Peeters,R.:Uncouplingbiometricsfromtemplates\nforsecureandprivacy-preservingauthentication.In:ACMSACMAT(2017)M.Zhangetal.\n4.AlReshan,M.,Liu,H.,Hu,C.,Yu,J.:MBPSKA:multi-biometricandphysiologicalsignal-basedkeyagreementforbodyareanetworks.IEEEAccess7,78484–78502\n5.Billeb,S.,Rathgeb,C.,Reininger,H.,Kasper,K.,Busch,C.:Biometrictemplateprotectionforspeakerrecognitionbasedonuniversalbackgroundmodels.IETBiometrics4(2),116–126(2015)\n6.Calleja,A.,Peris-Lopez,P.,Tapiador,J.E.:Electricalheartsignalscanbemonitoredfromthemoon:securityimplicationsforIPI-basedprotocols.In:WISTP,pp.36–51(2015)\n7.Cherukuri,S.,Venkatasubramanian,K.K.,Gupta,S.K.S.:BioSec:abiometricbasedapproachforsecuringcommunicationinwirelessnetworksofbiosensorsimplantedinthehumanbody.In:ICPP,pp.432–439(2003)\n8.CrossbowTechnologyInc.:TelosBMotePlatformdatasheet,Rev.B,https://www.\nwillow.co.uk/TelosBDatasheet.pdf\n9.Delvaux,J.,Gu,D.,Schellekens,D.,Verbauwhede,I.:HelperdataalgorithmsforPUF-basedkeygeneration:overviewandanalysis.IEEETCAD34(6),889–902\n10.Dodis,Y.,Ostrovsky,R.,Reyzin,L.,Smith,A.:Fuzzyextractors:howtogeneratestrongkeysfrombiometricsandothernoisydata.SIAMJ.Comput.38(1),97–139\n11.Halperin,D.,Heydt-Benjamin,T.S.,Fu,K.,Kohno,T.,Maisel,W.H.:Securityandprivacyforimplantablemedicaldevices.IEEEPervasiveComput.Spec.IssueImplantableElectron.7,30–39(2008)\n12.Hinterw¨alder,G.,Moradi,A.,Hutter,M.,Schwabe,P.,Paar,C.:Full-sizehighsecurityECCimplementationonMSP430microcontrollers.In:Aranha,D.F.,Menezes,A.(eds.)LATINCRYPT2014.LNCS,vol.8895,pp.31–47.Springer,Cham(2015).https://doi.org/10.1007/978-3-319-16295-92\n", "0microcontrollers.In:Aranha,D.F.,Menezes,A.(eds.)LATINCRYPT2014.LNCS,vol.8895,pp.31–47.Springer,Cham(2015).https://doi.org/10.1007/978-3-319-16295-92\n13.Hirose,S.:Someplausibleconstructionsofdouble-block-lengthhashfunctions.In:FSE,pp.210–225(2006)\n14.Hu,C.,Cheng,X.,Zhang,F.,Wu,D.,Liao,X.,Chen,D.:OPFKA:secureandeﬃcientordered-physiological-feature-basedkeyagreementforwirelessbodyareanetworks.In:INFOCOM(2013)\n15.Juels,A.,Sudan,M.:Afuzzyvaultscheme.Des.CodesCrypt.38(2),237–257\n16.Juels,A.,Wattenberg,M.:Afuzzycommitmentscheme.In:ACMCCS(1999)17.Kholmatov,A.,Yanikoglu,B.:Realizationofcorrelationattackagainstthefuzzyvaultscheme.In:Security,Forensics,Steganography,andWatermarkingofMultimediaContentsX,vol.6819,p.68190O.SPIE(2008)\n18.Li,X.,Zeng,Q.,Luo,L.,Luo,T.:T2Pair:secureandusablepairingforheteroge\nneousIoTdevices.In:ACMCCS,pp.309–323(2020)\n19.Lin,S.,Costello,D.J.:ErrorControlCoding,vol.2.PrenticeHall(2001)20.Marin,E.,ArgonesR´ua,E.,Singel´ee,D.,Preneel,B.:Onthediﬃcultyofusingpatient’sphysiologicalsignalsincryptographicprotocols.In:ACMSACMAT,pp.113–122(2019)\n21.Marin,E.,Mustafa,M.A.,Singel´ee,D.,Preneel,B.:Aprivacy-preservingremotehealthcaresystemoﬀeringend-to-endsecurity.In:Mitton,N.,Loscri,V.,Mouradian,A.(eds.)ADHOC-NOW2016.LNCS,vol.9724,pp.237–250.Springer,Cham(2016).https://doi.org/10.1007/978-3-319-40509-417\n", "urity.In:Mitton,N.,Loscri,V.,Mouradian,A.(eds.)ADHOC-NOW2016.LNCS,vol.9724,pp.237–250.Springer,Cham(2016).https://doi.org/10.1007/978-3-319-40509-417\n22.Marin,E.,Singel´ee,D.,Garcia,F.D.,Chothia,T.,Willems,R.,Preneel,B.:Onthe(in)securityofthelatestgenerationimplantablecardiacdeﬁbrillatorsandhowtosecurethem.In:ACSAC,pp.226–236(2016)23.Marin,E.,Singel´ee,D.,Yang,B.,Verbauwhede,I.,Preneel,B.:Onthefeasibility\nofcryptographyforawirelessinsulinpumpsystem.In:CODASPY(2016)\n24.Marin,E.,etal.:Securingwirelessneurostimulators.In:CODASPY,pp.287–298\n25.deMeulenaer,G.,Gosset,F.,Standaert,F.,Pereira,O.:Ontheenergycostofcommunicationandcryptographyinwirelesssensorsnetworks.In:IEEEWiMob,pp.580–585(2008)\n26.OrtizMartin,L.,Picazo-Sanchez,P.,Peris-Lopez,P.,Tapiador,J.:Heartbeatsdonotmakegoodpseudo-randomnumbergenerators:ananalysisoftherandomnessofinter-pulseintervals.Entropy20,94(2018)\n27.Rathgeb,C.,Uhl,A.:Statisticalattackagainstfuzzycommitmentscheme.IET\nBiometrics1(2),94–104(2012)\n28.Reparaz,O.,Balasch,J.,Verbauwhede,I.:Dude,ismycodeconstanttime?In:\nDATE,pp.1697–1702.IEEE(2017)\n29.Reverberi,L.,Oswald,D.:Breaking(andﬁxing)awidelyusedcontinuousglucose\nmonitoringsystem.In:USENIXWOOT(2017)\n30.Rostami,M.,Juels,A.,Koushanfar,F.:Heart-to-Heart(H2H):authenticationfor\nimplantedmedicaldevices.In:ACMCCS,pp.1099–1112(2013)\n31.Seepers,R.M.,Strydis,C.,Peris-Lopez,P.,Sourdis,I.,Zeeuw,C.I.D.:Peakmisdetectioninheart-beat-basedsecurity:characterizationandtolerance.In:EMBC,pp.5401–5405(2014)\n", ",Strydis,C.,Peris-Lopez,P.,Sourdis,I.,Zeeuw,C.I.D.:Peakmisdetectioninheart-beat-basedsecurity:characterizationandtolerance.In:EMBC,pp.5401–5405(2014)\n32.Seepers,R.M.,Wang,W.,deHaan,G.,Sourdis,I.,Strydis,C.:Attacksonheartbeat-basedsecurityusingremotephotoplethysmography.IEEEJ-BHI22(3),714–721(2018)33.Singel´ee,D.,Seys,S.,Batina,L.,Verbauwhede,I.:Theenergybudgetforwireless\nsecurity:extendedversion.IACRCryptol.ePrintArch.2015,1029(2015)34.TI:AN092:MeasuringBluetoothLowEnergyPowerConsumption(2012)35.TI:MSP430FR596x,MSP430FR594xMixed-SignalMicrocontrollersdatasheet\n(2012).rev.G.https://www.ti.com/lit/gpn/msp430fr5969\n36.TI:MSP430FR599x,MSP430FR596xMixed-SignalMicrocontrollersdatasheet\n(2016).rev.C.https://www.ti.com/lit/gpn/msp430fr5994\n37.Venkatasubramanian,K.K.,Banerjee,A.,Gupta,S.:Plethysmogram-basedsecureinter-sensorcommunicationinbodyareanetworks.In:IEEEMILCOM(2008)38.Venkatasubramanian,K.K.,Banerjee,A.,Gupta,S.K.S.:PSKA:usableandsecurekeyagreementschemeforbodyareanetworks.IEEET-ITB14(1),60–68(2010)39.Venkatasubramanian,K.K.,Gupta,S.K.S.:Physiologicalvalue-basedeﬃcientusablesecuritysolutionsforbodysensornetworks.ACMTOSN6(4),1–36(2010)40.Xu,F.,Qin,Z.,Tan,C.C.,Wang,B.,Li,Q.:IMDGuard:securingimplantablemedicaldeviceswiththeexternalwearableguardian.In:IEEEINFOCOM(2011)\n\n"]